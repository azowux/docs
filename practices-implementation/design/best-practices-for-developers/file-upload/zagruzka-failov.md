---
description: Безопасная загрузка файлов на сервер
---

# Загрузка файлов

### Рекомендации <a id="&#x420;&#x435;&#x43A;&#x43E;&#x43C;&#x435;&#x43D;&#x434;&#x430;&#x446;&#x438;&#x438;"></a>

1. На Back-end сервере используйте случайно созданное имя для хранения файла, вместо присланного пользователем.
2. Используйте белый список символов для имени файла
3. Если это невозможно, то очистите имя файла от спецсимволов. В частности от [RLO](https://xakep.ru/2018/02/13/telegram-rlo/).
4. Используйте только белые списки для проверки расширений файлов.
5. Для создания белого списка используйте следующую табличку:

| Mime types | Extensions | [Magic bytes](https://www.filesignatures.net/index.php?page=all) |
| :--- | :--- | :--- |
| image/jpeg | .jpeg/.jpg | FF D8 FF E0 |

1. Все проверки на стороне клиента должны дублироваться на стороне сервера.
2. Храните файлы за пределами корневой папки веб приложения.
3. Отберите у файловой системы возможность запуска файлов.

### Валидация расширения: <a id="&#x412;&#x430;&#x43B;&#x438;&#x434;&#x430;&#x446;&#x438;&#x44F;-&#x440;&#x430;&#x441;&#x448;&#x438;&#x440;&#x435;&#x43D;&#x438;&#x44F;:"></a>

* Расширение входит в список разрешенных расширений независимо от регистра.
*  Mime-type входит в список разрешенных \(если к вам в приложение должен прилетать mime-type = octet-stream, то переходите к следующим проверкам\)
*  Бинарный заголовок файла входит в список разрешенных форматов файла.
*  Расширение, mime-type и бинарный заголовок принадлежат одному типу файлов.
*  Размер файла не превышает допустимый размер.

