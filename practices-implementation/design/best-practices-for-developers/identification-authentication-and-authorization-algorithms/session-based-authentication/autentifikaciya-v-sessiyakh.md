# Аутентификация в сессиях

## Сессии должны быть

* Сгенерированными с использованием криптостойкого рандома, алгоритм шифрования не должен быть предсказуемым  \([Пример эксплойта](https://github.com/tna0y/Python-random-module-cracker)\)
* Размер токена должен быть не менее 128 бит \(16 байт\) согласно [OWASP](https://owasp.org/www-community/vulnerabilities/Insufficient_Session-ID_Length)
* Сохраненными в куках со всеми флагами безопасности \(secure, httponly, SameSite=Lax\)
* Отправленными через POST-метод и **никогда** через GET-метод
* Сгенерированными на бэкенде, бэкенд должен проверять, что сессия создана им, чтобы предотвратить session fixation атаку
* Обновлены при **любом** изменении уровня привилегий 
* Отправлены клиенту заголовком `cache-control: no-store`
* Привязаны к user-agent

{% hint style="info" %}
Избегайте создания своих имплементаций алгоритмов сессий, это может быть небезопасно
{% endhint %}



