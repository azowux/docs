# Аутентификация в сессиях

## Сессии должны быть

* Сгенерированными с использованием шифрования методом случайных чисел, алгоритм шифрования не должен быть предсказуемым  \([Пример эксплойта](https://github.com/tna0y/Python-random-module-cracker)\)
* Размер токена должен быть не менее 128 бит \(16 байт\) согласно [OWASP](https://owasp.org/www-community/vulnerabilities/Insufficient_Session-ID_Length)
* Сохраненными в хранилище куки со всеми флагами безопасности \(secure, httponly, SameSite=Lax\)
* Отправленными через POST-метод и **никогда** через GET-метод
* Сгенерированными на бэкенде и не должны быть сохранены через ввод пользователя, чтобы предотвратить атаку через фиксацию сессии
* Обновлены при **любом** изменении уровня привилегий 
* Отправлены клиенту через заголовок`cache-control: no-store`
* Привязаны к юзер-агенту

{% hint style="info" %}
Избегайте создания своих имплементаций алгоритмов сессий, это может быть небезопасно
{% endhint %}

